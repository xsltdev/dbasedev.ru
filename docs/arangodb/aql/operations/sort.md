# SORT

Оператор `SORT` принудительно отсортирует массив уже полученных промежуточных результатов в текущем блоке. `SORT` позволяет указать один или несколько критериев и направлений сортировки.

## Синтаксис

Общий синтаксис следующий:

<pre><code>SORT <em>expression</em> <em>direction</em></code></pre>

## Использование

Пример запроса, который сортирует по LastName (в порядке возрастания), затем по FirstName (в порядке возрастания), затем по id (в порядке убывания):

<!-- 0001.part.md -->

```aql
FOR u IN users
  SORT u.lastName, u.firstName, u.id DESC
  RETURN u
```

<!-- 0002.part.md -->

Указание _направления_ необязательно. По умолчанию (неявное) направление для выражения сортировки - это порядок по возрастанию. Чтобы явно указать направление сортировки, можно использовать ключевые слова `ASC` (по возрастанию) и `DESC`. Несколько критериев сортировки могут быть разделены запятыми. В этом случае направление указывается для каждого выражения отдельно. Например

<!-- 0003.part.md -->

```aql
SORT doc.lastName, doc.firstName
```

<!-- 0004.part.md -->

сначала отсортирует документы по фамилии в порядке возрастания, а затем по имени в порядке возрастания.

<!-- 0005.part.md -->

```aql
SORT doc.lastName DESC, doc.firstName
```

<!-- 0006.part.md -->

сначала отсортирует документы по LastName в порядке убывания, а затем по FirstName в порядке возрастания.

<!-- 0007.part.md -->

```aql
SORT doc.lastName, doc.firstName DESC
```

<!-- 0008.part.md -->

сначала отсортирует документы по LastName в порядке возрастания, а затем по FirstName в порядке убывания.

!!!warning ""

    При итерации по массивам, основанным на коллекциях, порядок документов всегда **не определен, если не задан явный порядок сортировки** с помощью `SORT`.

Постоянные выражения `SORT` могут быть использованы для указания того, что не требуется определенный порядок сортировки.

<!-- 0009.part.md -->

```aql
SORT null
```

<!-- 0010.part.md -->

Постоянные выражения `SORT` будут отсортированы оптимизатором AQL во время оптимизации, но их явное указание может позволить дальнейшую оптимизацию, если оптимизатору не нужно учитывать какой-либо конкретный порядок сортировки. Это особенно актуально после оператора `COLLECT`, который должен выдать отсортированный результат. Указание дополнительного `SORT null` после оператора `COLLECT` позволяет оптимизатору AQL полностью убрать пост-сортировку результатов сбора. Также смотрите [`COLLECT` опция `method`](collect.md).

<!-- 0011.part.md -->
